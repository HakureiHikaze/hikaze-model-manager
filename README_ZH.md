# Hikaze Model Manager

[![English](https://img.shields.io/badge/README-English-blue)](README.md)

一个为 ComfyUI 设计的综合模型管理插件，提供直观的界面来组织、选择和管理 AI 模型，具备高级工作流集成功能。

## 概述

Hikaze Model Manager 通过提供既有选择功能又有管理功能的先进模型管理系统来增强您的 ComfyUI 体验。无论您需要为工作流快速选择模型，还是管理详细的元数据，这个插件都能提供无缝的解决方案。

## 功能特性

### 🎯 双模式界面
- **模型选择器**：隐藏标签页界面，具备预选功能，用于工作流集成
- **模型管理器**：功能齐全的标签页界面，用于全面的模型元数据管理

### 🔧 增强的自定义节点
- **检查点选择器**：具有视觉反馈的高级模型选择
- **Power LoRA 加载器**：多重 LoRA 堆叠，支持单独强度控制和绕过功能

### 🖥️ 智能后端
- **自动服务**：自启动 HTTP 服务器（默认端口 8789），实现无缝操作
- **智能扫描**：高效的模型发现和元数据提取
- **数据库管理**：模型信息和用户自定义的持久化存储

### 🌐 多语言支持
- 英文和中文（简体）界面
- 自动语言检测，支持手动覆盖选项

### ⚡ 性能优化
- 零影响插件加载，延迟依赖导入
- 多线程后端服务，确保响应式用户界面
- 高效的模型扫描和缓存

## 安装

1. 将此仓库克隆或下载到您的 ComfyUI 自定义节点目录：
   ```bash
   cd ComfyUI/custom_nodes/
   git clone https://github.com/HakureiHikaze/hikaze-model-manager.git
   ```

2. 重启 ComfyUI - 插件将自动启动其后端服务

3. 通过以下方式访问模型管理器：
   - **右键菜单**：ComfyUI 界面中的"模型管理器"按钮
   - **节点按钮**：兼容加载器节点上的"选择模型"按钮

## 使用方法

### 模型选择模式
- 通过加载器节点按钮打开，预选模型类别
- 隐藏标签页界面，专注于快速选择
- 直接将选定的模型返回给调用节点
- 支持 LoRA 加载器的多选和强度控制

### 模型管理模式
- 通过主 ComfyUI 菜单按钮打开
- 完整的标签页界面，用于全面的模型组织
- 编辑模型元数据、标签和描述
- 上传和管理模型预览图片
- 无需选择确认 - 更改自动保存

### Power LoRA 加载器
- 堆叠多个 LoRA，支持单独强度控制
- 模型和 CLIP 输入为必需连接
- 动态参数注入，支持灵活的工作流设计
- 绕过功能，便于快速启用/禁用

## 架构

### 后端服务
- **HTTP 服务器**：RESTful API 用于模型操作
- **扫描模块**：智能模型发现和处理
- **数据库层**：基于 SQLite 的模型元数据存储
- **配置系统**：灵活的设置管理

### 前端界面
- **Web 应用**：现代响应式界面
- **ComfyUI 集成**：无缝工作流集成
- **实时更新**：与后端实时同步

### 自定义节点
- **模块化设计**：清晰的关注点分离
- **灵活输入类型**：受 rgthree 启发的动态参数设计
- **UI 增强**：自定义控件，改善用户体验

## 配置

插件使用自动配置和合理的默认值：
- **服务器主机**：127.0.0.1 (本地主机)
- **服务器端口**：8789
- **模型根目录**：从 ComfyUI 设置自动检测
- **语言**：从浏览器设置自动检测

## 开发

### 插件结构
```
hikaze-model-manager/
├── __init__.py                 # 插件入口点和节点注册
├── backend/                    # 后端服务模块
│   ├── server.py              # HTTP 服务器实现
│   ├── scanner.py             # 模型扫描逻辑
│   ├── db.py                  # 数据库操作
│   └── config.py              # 配置管理
├── nodes/                      # 自定义 ComfyUI 节点
│   ├── checkpoint_selector.py # 检查点选择节点
│   └── power_lora_loader.py   # 增强的 LoRA 加载器
└── web/                        # 前端界面
    ├── app.js                 # 主应用逻辑
    ├── comfyui_extension.js   # ComfyUI 集成
    └── *.html                 # 界面模板
```

### 设计原则
- **零影响加载**：ComfyUI 启动期间无重量级导入
- **延迟初始化**：仅在需要时加载组件
- **错误恢复**：组件故障时优雅降级
- **可扩展架构**：易于添加新功能和节点

## 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件。

## 致谢

- 设计模式受 [rgthree ComfyUI 插件](https://github.com/rgthree/rgthree-comfy) 启发
- 为 ComfyUI 社区而构建

## 支持

如有问题、疑问或贡献，请访问 [GitHub 仓库](https://github.com/HakureiHikaze/hikaze-model-manager)。